# Tasks: improve-natal-chart-ux

## Implementation Checklist

### Phase 1: 智能默认值
- [x] 实现当前时间自动填充（年/月/日/时/分）
- [x] 实现时区自动检测（通过 Intl.DateTimeFormat）
- [x] 集成 IP 地理定位 API (ip-api.com)
- [x] 自动填充城市名称和经纬度
- [x] 处理 API 失败时的降级方案

### Phase 2: 实时更新
- [x] 移除"生成星盘"按钮
- [x] 添加输入防抖机制 (500ms)
- [x] 所有输入字段添加 input 事件监听
- [x] 页面加载时自动生成初始星盘
- [x] 添加轻量级更新指示器（替代全屏 loading）

### Phase 3: 天体选择器
- [x] 定义天体数据结构（主要行星 + 小行星/特殊点）
- [x] 添加天体选择 UI（可折叠面板）
- [x] 实现天体勾选状态管理
- [x] 更新星盘渲染逻辑（根据选择过滤天体）
- [x] 更新行星表格显示

### Phase 4: 界面优化
- [x] 统一使用中文天体名称
- [x] 优化输入面板布局
- [x] 添加天体分组标题（主要行星/小行星和特殊点）
- [x] 保存天体选择到 localStorage

### Validation
- [x] 测试自动时间/时区填充
- [x] 测试 IP 定位（不同网络环境）
- [x] 测试实时更新防抖效果
- [x] 测试天体选择持久化
- [x] 测试 API 失败降级

## Dependencies

```
Phase 1 (智能默认值)
    ↓
Phase 2 (实时更新) → Phase 3 (天体选择器)
                          ↓
                    Phase 4 (界面优化)
```

## Acceptance Criteria

1. 页面加载后立即显示当前时间/位置的星盘
2. 任何输入变化后 500ms 内自动更新星盘
3. 无需点击按钮即可生成星盘
4. 可以勾选/取消勾选要显示的天体
5. 主要行星默认显示，小行星/特殊点默认隐藏
6. 所有天体名称为中文
7. 设置在刷新后保持
